// Порядок категорий для отображения в UI
export const CATEGORY_ORDER = [
  'Вино',
  'Водка',
  'Виски',
  'Коньяк',
  'Ром',
  'Портвейн',
  'Текила',
  'Джин',
  'Ликер',
  'Настойки',
  'Шампанское',
  'Игристое',
  'Вермут',
  'Пиво',
  'Пиво больше 1л',
  'Пиво разливное',
  'Напитки',
  'Электронки',
  'Сигареты и стики',
  'Снэки и сухарики',
  'Мясо и рыба',
  'Шоколад'
];

// Подкатегории для каждой категории (порядок отображения)
export const SUBCATEGORIES_BY_CATEGORY = {
  'Вино': [
    'Белое сухое',
    'Белое полусладкое',
    'Белое полусухое',
    'Белое сладкое',
    'Розовое сухое',
    'Розовое полусухое',
    'Розовое',
    'Красное сухое',
    'Красное полусладкое',
    'Красное полусухое',
    'Красное сладкое',
    'Кагор',
  ],
  'Игристое': [
    'Просекко/Брют',
    'Просекко',
    'Брют',
    'Асти',
    'Экстра Драй',
  ],
};

// Определение подкатегории товара по его названию
// Порядок важен: более специфичные проверки идут первыми
const SUBCATEGORY_RULES = [
  // Игристые — проверяем до цветовых, т.к. могут содержать "белое"
  { name: 'Экстра Драй', test: (n) => /экстра\s*драй|extra\s*dry/i.test(n) },
  { name: 'Просекко', test: (n) => /просекко|prosecco/i.test(n) },
  { name: 'Асти', test: (n) => /асти|asti/i.test(n) },
  { name: 'Брют', test: (n) => /брют|brut/i.test(n) },

  // Кагор
  { name: 'Кагор', test: (n) => /кагор/i.test(n) },

  // Настойки
  { name: 'Настойки', test: (n) => /настойк/i.test(n) },

  // Розовое — конкретные перед общим
  { name: 'Розовое полусухое', test: (n) => /розов/i.test(n) && /полусух/i.test(n) },
  { name: 'Розовое сухое', test: (n) => /розов/i.test(n) && /сух/i.test(n) },
  { name: 'Розовое', test: (n) => /розов/i.test(n) },

  // Красное
  { name: 'Красное полусладкое', test: (n) => /красн/i.test(n) && /полусладк/i.test(n) },
  { name: 'Красное полусухое', test: (n) => /красн/i.test(n) && /полусух/i.test(n) },
  { name: 'Красное сладкое', test: (n) => /красн/i.test(n) && /сладк/i.test(n) },
  { name: 'Красное сухое', test: (n) => /красн/i.test(n) && /сух/i.test(n) },

  // Белое
  { name: 'Белое полусладкое', test: (n) => /бел/i.test(n) && /полусладк/i.test(n) },
  { name: 'Белое полусухое', test: (n) => /бел/i.test(n) && /полусух/i.test(n) },
  { name: 'Белое сладкое', test: (n) => /бел/i.test(n) && /сладк/i.test(n) },
  { name: 'Белое сухое', test: (n) => /бел/i.test(n) && /сух/i.test(n) },

  // Фолбэки
  { name: 'Полусладкое', test: (n) => /полусладк/i.test(n) },
  { name: 'Полусухое', test: (n) => /полусух/i.test(n) },
  { name: 'Сладкое', test: (n) => /сладк/i.test(n) && !/полусладк/i.test(n) },
  { name: 'Сухое', test: (n) => /сух/i.test(n) && !/полусух/i.test(n) },
];

export function detectSubcategory(productName) {
  if (!productName) return '';
  const name = productName.trim();
  for (const rule of SUBCATEGORY_RULES) {
    if (rule.test(name)) {
      return rule.name;
    }
  }
  return '';
}

// Плоский список всех подкатегорий для фильтров
export const ALL_SUBCATEGORIES = [
  'Белое сухое',
  'Белое полусладкое',
  'Белое полусухое',
  'Белое сладкое',
  'Розовое сухое',
  'Розовое полусухое',
  'Розовое',
  'Красное сухое',
  'Красное полусладкое',
  'Красное полусухое',
  'Красное сладкое',
  'Кагор',
  'Просекко/Брют',
  'Просекко',
  'Брют',
  'Асти',
  'Экстра Драй',
  'Настойки',
];
